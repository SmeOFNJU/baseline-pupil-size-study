Baseline correction is part of what researchers often refer to as *preprocessing*: cleaning the raw data (i.e. as recorded by the eye tracker) from as many undesirable features as possible. Of course, what constitutes an undesirable feature depends on the context. For example, eye blinks are often considered undesirable in pupillometry, because you cannot measure pupil size while the eyes are closed, and also because blinks are followed by a prolonged constriction of the pupil [@Knapen2016]. But in a different context, for example when using blink rate as a measure of fatigue [@Stern1994], eye blinks can also be the measure of interest. In other words, preprocessing is performed differently in different situations.

++For pupillometry research, we recommend the following preprocessing steps.++ Baseline correction—the focus of this paper—is generally performed last.


### Dealing with missing data

Missing data most often occurs when a video-based eye tracker fails to extract the pupil from the camera image. Most eye trackers will then report a pupil size of 0, or indicate in some other way that data is missing. The first step in dealing with missing data is therefore to find out how the eye tracker reports missing data (e.g. as 0s), and then to ignore these values, for example by treating them as *nan* (not a number) values during the analysis; nan values are offered by most modern programming languages, and are a standard way to silently ignore missing data.

Whether missing data deserves special treatment is a matter of opinion. Some researchers prefer to interpolate missing data [e.g. @Knapen2016], similar to eye-blink reconstruction as discussed below. Other researchers prefer to exclude trials with too much missing data [e.g. @Koelewijn2012]. In our view, missing data needs no special treatment because what is not there does not affect the results anyway—as long as care is taken that missing data is not interpreted as real 0 pupil-size measurements, and as long as the proportion of missing data is independent of pupil size (i.e. data for large pupils is equally likely to be missing as for small pupils) and experimental conditions (i.e. data in one condition is equally likely to be missing as for another condition).


### Dealing with eye blinks and other unrealistic pupil size values

A bigger problem occurs when pupil-size values are reported incorrectly but not marked as missing data. The size of the pupil changes at most by a factor of around 4, when expressed as pupil diameter, or around 16, when expressed as pupil surface [@McdougalGamlin2008]. If pupil size, as measured, changes more than this, this means that something distorted the recording. By far the most common source of distortion is eye blinks; eye blinks are characterized by a rapid decrease in pupil size, followed by a period of missing data, followed by a rapid increase in pupil size. The period of missing data can be treated (or not) as discussed above; but the preceding and following distortions should be corrected, because they can strongly affect pupil size, even when averaged across many trials.

One way to deal with eye blinks, and our preferred method, is to use cubic-spline interpolation. This method is described in more detail elsewhere [@Math2013Simple] but in a nutshell works as follows: Four points (A, B, C, and D) are placed around the on- and offset of the blink. Point B is placed slightly before the onset of the blink; point C is placed slightly after the onset of the blink. Point A is then placed before point B; point D is placed after point C. Points are equally spaced, such that the distances between A and B, B and C, etc. are constant. Finally, a smooth line is drawn through all four points, replacing the missing and distorted data between B and C.


### Dealing with position artifacts

Imagine that a participant looks directly at the lens of a video-based eye tracker. The pupil is then recorded as a near-perfect circle. Now imagine that the participant makes an eye movement to the right, thus causing the eye ball to rotate, changing the angle from which the eye tracker records the pupil, and causing the horizontal diameter of the pupil (as recorded) to decrease. In other words, pupil size as recorded by the eye tracker decreases, even though pupil size really did not change. ++Most commonly used eye trackers, such as the EyeLink (SR Research, Missisauga, Ontario, Canada) cannot distinguish such artifactual pupil-size changes due to eye movements from real pupil-size changes. Eye trackers that work with a physical model of the eye, such as Pupil Labs (Pupil Labs, Berlin, Germany), in theory could distinguish artifactual from real pupil-size changes, as described below.++

++Importantly, artifactual pupil-size changes can be larger than the real pupil-size changes that are induced by many psychological manipulations. For example, Figure 5 from @MathôtMelmiCastet2015 shows pupil size during eye movements in four directions (leftward, rightward, upward, and downward). In this particular set-up, a downward eye movement movement caused an artifactual increase in pupil size of 10%. This is comparable to the largest (real) change in pupil size that @KahnemanBeatty1966 observed in a working-memory task.++

++There are three main ways to take position artifacts in pupil-size data into account: comparing conditions that are matched in terms of eye position [e.g. @Gagl2011]; using data-driven correction, which uses linear regression to remove position artifacts from pupil-size data [e.g. @Brisson2013]; and model-driven correction, which uses knowledge about the relative positions of the camera, eyes, and eye tracker [e.g. @Gagl2011; @HayesPetrov2016].++

++When comparing conditions that are matched on eye position, the eyes may still move, as long as they do so in the same way in all conditions. For example, @Gagl2011 compared pupil size between a condition in which participants read real sentences, and a condition in which participants read z-strings (i.e. strings where all characters of the real text were replaced by 'z's). Because eye movements did not differ between these two conditions, any difference in pupil size is real and due to the difference between conditions (in this case due to the cognitive processes involved in reading). Whenever you are not interested in absolute pupil-size measurements, and whenever it is practically feasible to match eye position between conditions, this is unequivocally the best way to take position artifacts into account—because it does not rely on any assumptions.++

Data-driven correction involves a calibration procedure during which participants look at points on different parts of the screen [e.g. @Brisson2013]. A multiple linear regression is then performed to predict pupil size from horizontal (X) and vertical (Y) pupil size. Using this regression, position artifacts could then be removed from pupil size during the rest of the experiment. This procedure assumes that, in reality, pupil size does not depend on eye position, and any measured relationship is therefore artifactual.

Unfortunately, this procedure does not work for the simple reason that pupil size may actually (and usually does) change as a function of eye position. For example, if participants need to look up uncomfortably to foveate the top of the screen, the mental and physical effort involved may cause their pupils to dilate. When performing a correction as described above, this real pupil-size change would be corrected as though it were artifactual. Even worse, artifactual pupil-size changes happen immediately when the eyes move, whereas real pupil-size changes occur slowly. Therefore, they have to be treated differently; if not, pupil size may seem completely free of position artifacts just before each eye movement, but catastrophically affected by position artifacts immediately after each eye movement. We have seen this in our data, and decided to leave position artifacts uncorrected for exactly this reason [@MathôtMelmiCastet2015].

++Model-based correction requires knowledge of the geometry of the eyes and the recording set-up: the position of the eyes relative to the display and the eye tracker [e.g. @Gagl2011;@HayesPetrov2016], and, for even more accurate correction, the thickness of the iris [e.g. @Gagl2011] and the focusing power of the cornea and lens, which affect the appearance of the pupil, especially when viewed off-axis [e.g. @Mathur2013].++ Once you have constructed a physical model based on this information, position artifacts can be isolated and removed from pupil-size measurements. Studies using an artificial pupil of fixed size (so that true pupil size is known) have shown that model-based correction is highly effective [@Gagl2011;@HayesPetrov2016]. Crucially, and unlike data-driven correction, model-based correction does not inappropriately 'correct' for real pupil size changes that may accompany ++changes in++ gaze position.

++To summarize, the size of the pupil changes as a function of eye position, and this is in part an artifact due to the angle from which the eye tracker records the pupil. Ideally, pupil size is compared between conditions that are matched on eye position, in which case pupil-size differences between conditions are not confounded by position artifacts. When such matching is not feasible, the best way to remove position artifacts from pupil-size data is using a model-based correction that takes into account the geometry of the eye and the recording set-up [e.g. @Gagl2011;@HayesPetrov2016].++


### Hope for the best, prepare for the worst

Data preprocessing is useful, improves statistical power (the probability of detecting true effects), ++reduces the probability of spurious results++, and makes it substantially easier to analyze and interpret results. However, eye-movement data is messy, and every form of preprocessing is guaranteed to fail occasionally. For example, blink reconstruction often fails when the eyes close only partly (is that even a blink?) or when due to noise the blink is not detected.

Therefore, results should not crucially depend on whether the data still contains artifacts. Similarly, one preprocessing step should not crucially depend on whether the previous preprocessing step was perfect. For this reason, in this paper we focus on baseline correction in isolation, as if no preprocessing steps are performed beforehand. However, in real-life situations, baseline correction generally is—and should be—accompanied by others forms of preprocessing.
